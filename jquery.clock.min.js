(function(g,r){r.Clock=function(b){function p(){"down"===a.direction?e.setUTCSeconds(e.getUTCSeconds()-1):e.setUTCSeconds(e.getUTCSeconds()+1);a.render(e);a.elem.triggerHandler("clock.onStep");h&&("down"===a.direction?0>=e-h&&(a.isStop=!0):0<=e-h&&(a.isStop=!0),a.isStop&&a.stop())}function m(){a.isPlay&&(a.isPlay=!1,clearInterval(v))}function q(){b.btns&&g.each(b.btns,function(){g(this).off("click")});a.stop();a.elem.data("clock",null)}function r(){switch(a.renderType){case "img":var f=function(c,
b,f,d){t[b].charAt(d)!==f.charAt(d)&&("down"===a.direction?c.animate({"margin-top":a.frameHeight},function(){c.parent().prepend(c.siblings(":last"));c.css({"margin-top":0})}):c.animate({"margin-top":-a.frameHeight},function(){c.parent().append(c);c.css({"margin-top":0})}))},c=function(c,b,f){return"down"===a.direction?c.find(">div>div:first"):c.find(".clock_rndrimg-dig-"+b.charAt(f)).prev()},b=s(e);f(c(a.rndrItems.hh[1],b.hh,0),"hh",b.hh,0);f(c(a.rndrItems.hh[2],b.hh,1),"hh",b.hh,1);f(c(a.rndrItems.min[1],
b.min,0),"min",b.min,0);f(c(a.rndrItems.min[2],b.min,1),"min",b.min,1);f(c(a.rndrItems.ss[1],b.ss,0),"ss",b.ss,0);f(c(a.rndrItems.ss[2],b.ss,1),"ss",b.ss,1);g.extend(t,b);break;default:var f=function(c){for(var b=1;2>=b;b++)a.rndrItems[c][b].html(d[c].charAt(b-1))},d=s(e);f("dd");f("mm");f("yy");f("hh");f("min");f("ss")}}function n(f){if(g.isFunction(b[f]))a.elem.on("clock."+f,b[f])}function s(a){var c={dd:"",mm:"",yy:"",hh:"",min:"",ss:""};c.dd=a.getUTCDate();10>c.dd&&(c.dd="0"+c.dd);c.dd=c.dd.toString();
c.mm=a.getUTCMonth()+1;10>c.mm&&(c.mm="0"+c.mm);c.mm=c.mm.toString();c.yy=a.getUTCFullYear()%100;10>c.yy&&(c.yy="0"+c.yy);c.yy=c.yy.toString();c.hh=a.getUTCHours();10>c.hh&&(c.hh="0"+c.hh);c.hh=c.hh.toString();c.min=a.getUTCMinutes();10>c.min&&(c.min="0"+c.min);c.min=c.min.toString();c.ss=a.getUTCSeconds();10>c.ss&&(c.ss="0"+c.ss);c.ss=c.ss.toString();return c}var a=this;this.elem=b.elem;this.timeDif=b.timeDif||b.elem.data("timeDif")||!1;this.timeZone=+b.timeZone||+b.elem.data("timezone");this.direction=
b.direction||b.elem.data("direction");this.timer=b.timer||b.elem.data("timer")||!1;this.startTime=b.startTime||b.elem.data("startTime")||0;this.autoStart=void 0!==b.autoStart?b.autoStart:void 0!==b.elem.data("autoStart")?b.elem.data("autoStart"):!0;this.isStop=this.isPlay=!1;this.sRndrTpl=b.sRndrTpl||b.elem.data("sRndrTpl")||"dd;.;mm;.;yy; ;hh;:;min;:;ss";this.render=b.render||!1;this.renderType=b.renderType||b.elem.data("renderType")||"num";this.frameHeight=b.frameHeight||b.elem.data("frameHeight")||
32;this.rndrItems={};var e,h,v,t={dd:"00",mm:"00",yy:"0000",hh:"00",min:"00",ss:"00"};this.play=function(){!a.isPlay&&!a.isStop&&(a.isPlay=!0,v=setInterval(p,1E3),a.elem.triggerHandler("clock.onPlay"))};this.pause=function(){var b=a.isPlay;m();b&&a.elem.triggerHandler("clock.onPause")};this.stop=function(){m();a.isStop=!0;a.elem.triggerHandler("clock.onStop",[a.getSurplus()])};this.getSurplus=function(){return Math.abs(e-h)/1E3};this.destroy=function(){q();a.elem.triggerHandler("clock.onDestroy");
a.elem.off("clock")};this.destroyHTML=function(){q();a.elem.html("");a.elem.triggerHandler("clock.onDestroyHTML");a.elem.off("clock")};var k=new Date;a.timeZone||(a.timeZone=-k.getTimezoneOffset()/60);a.timer&&(k.setUTCSeconds(0),k.setUTCMinutes(0),k.setUTCHours(0),"down"===a.direction&&k.setUTCSeconds(a.timeDif));e=new Date(k.getTime());a.timer||e.setUTCHours(e.getUTCHours()+a.timeZone);a.timeDif&&("down"===a.direction&&(a.timeDif*=-1),h=new Date(e.getTime()),a.timer?"down"===a.direction?(h.setUTCSeconds(0),
h.setUTCMinutes(0),h.setUTCHours(0)):h.setUTCSeconds(h.getUTCSeconds()+a.timeDif):h.setUTCSeconds(h.getUTCSeconds()+a.timeDif));a.timer&&a.startTime&&e.setUTCSeconds(a.startTime);a.timer&&(t=s(e));("down"===a.direction&&0>=e-h||"up"===a.direction&&0<=e-h)&&console&&console.log("\u0412\u043d\u0438\u043c\u0435\u043d\u0438\u0435: \u0442\u0430\u0439\u043c\u0435\u0440 \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u0448\u0430\u0433\u0430");a.elem.on("clock.play",function(){a.play()});a.elem.on("clock.pause",
function(){a.pause()});a.elem.on("clock.stop",function(){a.stop()});a.elem.on("clock.destroy",function(){a.destroy()});a.elem.on("clock.destroyHTML",function(){a.destroyHTML()});n("onCreate");n("onPlay");n("onStep");n("onPause");n("onStop");n("onDestroy");n("onDestroyHTML");if(!g.isFunction(a.render)){a.render=r;var j=function(b){b.len||(b.len=2);var c="clock_rndr-dig";switch(a.renderType){case "img":c+=" clock_rndr-dig__img"}for(var d="",e=1;e<=b.len;e++){d+='<div class="'+c+'" data-part="'+b.id+
"-"+e+'">';if("img"===a.renderType){for(var d=d+('<div class="clock_rndrimg-dig-set clock_rndrimg-dig-set__'+a.direction+'">'),h=Number(b.value.charAt(e-1)),g=1===e?b.cnt1+1:b.cnt2+1,k="",j=0,l=0;l<g;l++)j=l+h,"down"===a.direction&&j++,j>=g&&(j-=g),k+='<div class="clock_rndrimg-dig-set-item clock_rndrimg-dig-'+j+'"></div>';d+=k;d+="</div>"}else d+=b.value.charAt(e-1);d+="</div>"}return d},w=function(a,c){var b;b=""+('<div class="clock_rndr-delim clock_rndr-delim__'+a+'">')+c;return b+="</div>"},l=
s(e),k=a.sRndrTpl.split(";"),u="clock_rndr__num";switch(a.renderType){case "img":u+=" clock_rndr__img"}var d='<div class="clock_rndr '+u+'">';"img"===a.renderType?g.each(k,function(a,c){switch(c){case "hh":d+=j({id:"hh",value:l.hh,cnt1:2,cnt2:3});break;case "min":d+=j({id:"min",value:l.min,cnt1:5,cnt2:9});break;case "ss":d+=j({id:"ss",value:l.ss,cnt1:5,cnt2:9});break;default:d+=w(a,c)}}):g.each(k,function(a,c){switch(c){case "dd":d+=j({id:"dd",value:l.dd});break;case "mm":d+=j({id:"mm",value:l.mm});
break;case "yy":d+=j({id:"yy",value:l.yy});break;case "hh":d+=j({id:"hh",value:l.hh});break;case "min":d+=j({id:"min",value:l.min});break;case "ss":d+=j({id:"ss",value:l.ss});break;default:d+=w(a,c)}});d+="</div>";a.elem.html(d);"img"===a.renderType&&a.elem.find(".clock_rndrimg-dig-set").each(function(){g(this).height(g(this).find(".clock_rndrimg-dig-set-item").length*a.frameHeight)});a.rndrItems={dd:{1:a.elem.find('[data-part="dd-1"]'),2:a.elem.find('[data-part="dd-2"]')},mm:{1:a.elem.find('[data-part="mm-1"]'),
2:a.elem.find('[data-part="mm-2"]')},yy:{1:a.elem.find('[data-part="yy-1"]'),2:a.elem.find('[data-part="yy-2"]')},hh:{1:a.elem.find('[data-part="hh-1"]'),2:a.elem.find('[data-part="hh-2"]')},min:{1:a.elem.find('[data-part="min-1"]'),2:a.elem.find('[data-part="min-2"]')},ss:{1:a.elem.find('[data-part="ss-1"]'),2:a.elem.find('[data-part="ss-2"]')}}}a.render(e);b.btns&&g.each(b.btns,function(b,c){g(c).click(function(){a.elem.triggerHandler("clock."+b)})});a.elem.triggerHandler("clock.onCreate");a.autoStart&&
a.play()};g.fn.clock=function(b){return this.each(function(){var p=g(this),m=p.data("clock"),q="object"===typeof b?b:{};q.elem=p;m||(m=new r.Clock(q),p.data("clock",m));if("string"===typeof b)m[b]()})}})(window.jQuery,window);